$('#cashform').form({    on:'blur',    inline : true,    fields:{        cash_num:{          identifier :'cash_num',          rules:[{              type: 'empty',              prompt: '请输入金额'          },{              type:'regExp',              value : '/^(?!(0[0-9]{0,}$))[0-9]{1,}[.]{0,}[0-9]{0,}$/',              prompt:'请输入正数'          }          ]        },        user_id:{            identifier: 'user_id',            rules:[{                type:'empty',                prompt:'请选择玩家'            }]        },        pay_account:{            identifier: 'pay_account',            rules:[{                type:'empty',                prompt:'请选择操作账户'            }]        }    }});$(document).ready(function () {        load_group_list();    });function form_clear() {        $("#cash_num").val("");        $("#note").val("");    }function load_group_list() {        $('#club_account').load('/group_subs_list/')    }function getAccountInfo() {        var struserinfo=$("#user_id").dropdown('get value');        var user_info=struserinfo.split(",");        var user_id=user_info[0];        var account_id=user_info[1];        var user_name=$("#user_id").dropdown('get text');        $('.ui.second.modal').remove();        $('#account').load('/user_account_info/',{'user_id':user_id, 'account_id': account_id,'user_name':user_name});        $('#balance_list').load('/user_subs_balance_list/',{'user_id':user_id})    }    function cash_in_check() {        var flag = $("#cashform").form('is valid');        if (!flag){            alert('请填写完整信息')        }        else {            var user_name=$("#user_id").dropdown('get text');            var change_num=$("#cash_num").val();            var pay_account=$("#pay_account").dropdown('get text');            var message = '确认给玩家【' + user_name + '】存款' + change_num + '积分;存款账户【' + pay_account + '】?';            $('#msg1').text(message);            $('#message_modal').modal('show')        }    }    function cash_in() {        var flag = $("#cashform").form('is valid');        if (!flag){            alert('请填写完整信息')        }        else {            var struserinfo=$("#user_id").dropdown('get value');            var user_info=struserinfo.split(",");            var user_id=user_info[0];            var account_id= user_info[1];            var change_num=$("#cash_num").val();            var note=$("#note").val();            var type_id=1001;            var pay_account=$("#pay_account").dropdown('get value');            var user_name=$("#user_id").dropdown('get text');            $('#msg1').text("");            $.ajax({                url:'/user_balance_cash/',                type:'post',                data:{'user_id':user_id, 'account_id':account_id, 'change_num':change_num,'note':note, 'type_id':type_id,                            'pay_account_id': pay_account,'use_name':user_name},                success:function (result) {                    if(result==='True'){                        alert('存款成功');                        load_group_list();                        $('.ui.second.modal').remove();                        getAccountInfo();                        form_clear();                    }                    else {                        alert('存款失败')                    }                }            })        }    }function cash_out() {        var flag = $("#cashform").form('is valid');        if (!flag){            alert('请填写完整信息')        }        else {            var struserinfo=$("#user_id").dropdown('get value');            var user_info=struserinfo.split(",");            var user_id=user_info[0];            var account_id= user_info[1];            var change_num=$("#cash_num").val();            var note=$("#note").val();            var type_id=2001;            var pay_account=$("#pay_account").dropdown('get value');            var user_name=$("#user_id").dropdown('get text');            $('#msg2').text("");            $.ajax({                url:'/check_cash_balance/',                type:'post',                data:{'user_id':user_id, 'account_id':account_id, 'change_num':change_num,'note':note, 'type_id':type_id,                            'pay_account_id': pay_account,'use_name':user_name},                success:function (result) {                    if(result === 'False'){                        alert('指定账户余额不足');                    }                    else {                        //余额足够，开始结算                        $.ajax({                            url:'/user_balance_cash/',                            type:'post',                            data:{'user_id':user_id, 'account_id':account_id, 'change_num':change_num,'note':note, 'type_id':type_id,                                'pay_account_id': pay_account,'use_name':user_name},                            success:function (result) {                                if(result==='True'){                                    alert('结算成功');                                    load_group_list();                                    $('.ui.second.modal').remove();                                    getAccountInfo();                                    form_clear();                                }                                 else {                                    alert('结算失败')                                }                            }                        })                    }                }            })        }    }    function cash_out_check() {        var flag = $("#cashform").form('is valid');        if (!flag){            alert('请填写完整信息')        }        else {            var user_name=$("#user_id").dropdown('get text');            var change_num=$("#cash_num").val();            var pay_account=$("#pay_account").dropdown('get text');            var message = '确认给玩家【' + user_name + '】结算' + change_num + '积分;结算账户【' + pay_account + '】?';            $('#msg2').text(message);            $('#message_modal_out').modal('show')        }    }