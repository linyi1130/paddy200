from th.models import *from django.db import connectionimport datetimefrom django.db.models.aggregates import Maxfrom django.db.models.aggregates import Sumfrom django.contrib.auth.hashers import make_password,check_passwordfrom django.contrib import messagesimport timefrom django.utils.timezone import now, timedeltaimport copyimport randomfrom th.pokerConnection import *def func_get_clubid(club_name):    try:        result = poker_get_clubid(club_name)    except Exception as e:        return False    if result:        result = result[0]['clubId']    return resultdef func_register_club(club_name, game_club_id,club_level,club_short_name,water_rate,insurance_rate):    if Club.objects.filter(inactive_time='2037-01-01').filter(club_name=club_name).exists():        return False    if ClubId.objects.filter(inactive_time='2037-01-01').filter(game_club_id=game_club_id).exists():        return False    try:        t = ClubId(game_club_id=game_club_id,                   club_name=club_name)        t.save()    except Exception as e:        return False    try:        club_id = ClubId.objects.filter(inactive_time='2037-01-01').get(game_club_id=game_club_id).club_id    except Exception as e:        return False    try:        t = Club(club_id=club_id,                 game_club_id=game_club_id,                 club_level=club_level,                 club_name=club_name,                 club_short_name=club_short_name,                 water_rate=water_rate,                 insurance_rate=insurance_rate               )        t.save()    except Exception as e:        return False    return Truedef func_register_user_batch(game_club_id):    returndef func_clubuser_init(game_club_id):    list_game_user_id=poker_get_club_player_all(game_club_id)    str_game_user_id = ""    if list_game_user_id:        for t in list_game_user_id:            if str_game_user_id == "":                str_game_user_id =str_game_user_id + "("+copy.deepcopy(str(t))+")"            else:                str_game_user_id = str_game_user_id + ",("+copy.deepcopy(str(t))+")"    str_SQL="insert into tmp_gameUserId values" + str_game_user_id    with connection.cursor() as cursor:        cursor.callproc('clubPlayerBatch', (str_SQL, game_club_id))    list_user_name = poker_get_user_name_list(list_game_user_id)    str_user_name = ''    if list_user_name:        for t in list_user_name:            if str_user_name == '':                str_user_name = '(' + str(t['playerId']) + ',' + '"' + t['nickname'] + '"' + ')'            else:                str_user_name = str_user_name + ',(' + str(t['playerId']) + ',' + '"' + t['nickname'] + '"' + ')'    str_SQL = "insert into tmp_gameUserName values" + str_user_name    with connection.cursor() as cursor:        cursor.callproc('registerUserBatch', (str_SQL,))    return str_user_name